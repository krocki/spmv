# SpMV
Sparse Matrix-Vector (SpMV) bench.

`x` is a dense array

`y` is a dense array

`A` is a sparse matrix.

```y = Ax```

```
./spmva-M x024 - 1024 -r 0.05
```

```
M 1024, K 1024, rho 0.050, T gemm 0.026158, MFLOP/s 76.46, T spmv 0.000018 + 0.013132, NNZ A 52465, NNZ B 44, err = 0.000000, rho_a 0.050035, rho_b 0.042969
```


MacBookPro14,1, 2.3GHz i5, "-flto -mavx2 -Ofast -fomit-frame-pointer"
```
./bench.sh
```

```
    M,     K,    ra,    rx,       X,  t sgemm,   mF, gemm FL, t spmv b, t spmv a,   ops,  sp mFL,     nnz_a,  nnz_b,   r_a,   r_x, err
  256,   256, 0.500, 0.800,   1.453, 0.000125,  0.1,  1000.0, 0.000086, 0.001817,  0.05,   566.1,     32537,    201, 0.496, 0.785, 0.000000
  256,   256, 0.500, 0.200,   6.455, 0.000071,  0.1,  1760.6, 0.000011, 0.001272,  0.01,   860.9,     32477,     39, 0.496, 0.152, 0.000000
  256,   256, 0.050, 0.800,  13.400, 0.000067,  0.1,  1865.7, 0.000005, 0.000227,  0.01,  1027.3,      3273,    209, 0.050, 0.816, 0.000000
  256,   256, 0.050, 0.200,  33.500, 0.000067,  0.1,  1865.7, 0.000002, 0.000207,  0.00,   511.2,      3337,     42, 0.051, 0.164, 0.000000
 4096,   256, 0.500, 0.800,   3.067, 0.001098,  2.0,  1821.5, 0.000358, 0.011860,  0.76,  2128.0,    524815,    195, 0.501, 0.762, 0.000000
 4096,   256, 0.500, 0.200,  10.670, 0.001067,  2.0,  1874.4, 0.000100, 0.011368,  0.20,  1988.8,    524281,     51, 0.500, 0.199, 0.000000
 4096,   256, 0.050, 0.800,  26.167, 0.001099,  2.0,  1819.8, 0.000042, 0.004714,  0.08,  1897.4,     52735,    202, 0.050, 0.789, 0.000000
 4096,   256, 0.050, 0.200,  68.875, 0.001102,  2.0,  1814.9, 0.000016, 0.004721,  0.02,  1352.4,     52502,     55, 0.050, 0.215, 0.000000
  256,  4096, 0.500, 0.800,   2.496, 0.001203,  2.0,  1662.5, 0.000482, 0.013279,  0.80,  1660.0,    524621,   3274, 0.500, 0.799, 0.000000
  256,  4096, 0.500, 0.200,   5.901, 0.001198,  2.0,  1669.4, 0.000203, 0.016128,  0.21,  1018.6,    524881,    846, 0.501, 0.207, 0.000000
  256,  4096, 0.050, 0.800,  15.610, 0.001202,  2.0,  1663.9, 0.000077, 0.003751,  0.08,  1052.5,     52359,   3323, 0.050, 0.811, 0.000000
  256,  4096, 0.050, 0.200,  28.595, 0.001201,  2.0,  1665.3, 0.000042, 0.003778,  0.02,   492.1,     52478,    845, 0.050, 0.206, 0.000000
 4096,  4096, 0.500, 0.800,   3.021, 0.018716, 32.0,  1709.8, 0.006195, 0.258240, 12.80,  2065.8,   8392961,   3275, 0.500, 0.800, 0.000000
 4096,  4096, 0.500, 0.200,  12.248, 0.018789, 32.0,  1703.1, 0.001534, 0.257683,  3.07,  2000.1,   8391695,    785, 0.500, 0.192, 0.000000
 4096,  4096, 0.050, 0.800,  18.788, 0.018675, 32.0,  1713.5, 0.000994, 0.183524,  1.27,  1281.1,    838995,   3257, 0.050, 0.795, 0.000000
 4096,  4096, 0.050, 0.200,  49.288, 0.018680, 32.0,  1713.1, 0.000379, 0.183003,  0.32,   838.1,    838590,    811, 0.050, 0.198, 0.000000
```
